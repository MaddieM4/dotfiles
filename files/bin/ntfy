#!/bin/bash
set -e

export NTFY_DEFAULT_TOPIC="$USER-alerts"
ntfy() {
  local msg="$1"
  local topic="$2"
  if [ -z "$topic" ]; then
    topic="$NTFY_DEFAULT_TOPIC"
  fi
  curl -d "$msg" \
    -H "Authorization: Bearer $NTFY_TOKEN" \
    "https://ntfy.maddiem4.cc/$topic"
}

ntfy "$@"
